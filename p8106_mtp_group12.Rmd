---
title: "p8106_mtp"
author: "Abhishek Ajay"
date: "April 2, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ISLR)
library(glmnet)
library(caret)
library(corrplot)
library(plotmo)
```

```{r}
library(readr)

day = read.csv("day.csv")
head(day)

x = day %>% 
  select(-dteday) 
x = model.matrix(casual+registered+ cnt~., x)
corrplot(cor(x))
```

According to the above correlation plot, we decided to drop-- instant and intercept.

```{r}
day %>% 
  janitor::clean_names() %>% 
  mutate(season = as.factor(season), 
         yr = as.factor(yr), 
         mnth = as.factor(mnth), 
         holiday = as.factor(holiday), 
         weekday = as.factor(weekday), 
         workingday = as.factor(workingday),
         dteday = as.vector(dteday)
         ) %>% 
  select(-c(instant))
```

```{r}
x_1 = 
  day %>% 
  select(-c(casual, registered, cnt))

x_1 = model.matrix(~., x_1)
y = day[,c(11)]
ridge.mod <-glmnet(x_1, y, alpha=0, lambda =exp(seq(-1, 10, length=100)))
ridge.mod$lambda

coef(ridge.mod)
```

